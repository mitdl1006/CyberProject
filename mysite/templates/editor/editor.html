{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Markdown Styler</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&family=Fira+Code:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'editor/css/workspace.css' %}">
</head>
<body class="workspace" data-default-theme='{{ default_theme|escapejs }}'>
    <header class="workspace__topbar">
        <div class="topbar__branding">
            <div class="branding__mark">MS</div>
            <div>
                <h1 class="branding__title">Markdown Styler</h1>
                <p class="branding__subtitle">팔레트로 디자인을 입히고 즉시 PDF로 내보내세요</p>
            </div>
        </div>
        <div class="topbar__actions">
            <button id="btn-preview" class="btn btn--ghost" type="button">미리보기 새로고침</button>
            <button id="btn-download" class="btn btn--primary" type="button">PDF 다운로드</button>
        </div>
    </header>

    <main
        id="editor-root"
        class="workspace__layout"
        data-preview-url="{% url 'editor:preview' %}"
        data-pdf-url="{% url 'editor:pdf' %}"
    >
        <div class="palette-slot">
            <aside class="palette" aria-label="디자인 팔레트">
                <div class="palette__section">
                    <h2>문서</h2>
                    <label class="palette__field">
                        <span>문서 제목</span>
                        <input type="text" id="input-title" placeholder="Untitled" />
                    </label>
                    <label class="palette__field">
                        <span>본문 폰트</span>
                        <select id="select-font">
                            <option value="'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif">Noto Sans KR</option>
                            <option value="'Pretendard', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif">Pretendard</option>
                            <option value="'SUIT', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif">SUIT</option>
                            <option value="'IBM Plex Sans KR', sans-serif">IBM Plex Sans KR</option>
                            <option value="'Fira Code', monospace">Fira Code</option>
                        </select>
                    </label>
                    <label class="palette__field">
                        <span>본문 글자 크기</span>
                        <input type="range" id="range-font-size" min="12" max="22" step="1" />
                    </label>
                    <button type="button" class="btn btn--ghost palette__reset" id="btn-reset-theme">설정 초기화</button>
                </div>

                <div class="palette__section">
                    <h2>색상</h2>
                    <label class="palette__field">
                        <span>배경</span>
                        <input type="color" id="color-background" />
                    </label>
                    <label class="palette__field">
                        <span>본문</span>
                        <input type="color" id="color-text" />
                    </label>
                    <label class="palette__field">
                        <span>헤딩</span>
                        <input type="color" id="color-heading" />
                    </label>
                    <label class="palette__field">
                        <span>포인트</span>
                        <input type="color" id="color-accent" />
                    </label>
                    <label class="palette__field">
                        <span>인용문 배경</span>
                        <input type="color" id="color-blockquote-bg" />
                    </label>
                    <label class="palette__field">
                        <span>인용문 테두리</span>
                        <input type="color" id="color-blockquote-border" />
                    </label>
                    <label class="palette__field">
                        <span>코드 배경</span>
                        <input type="color" id="color-code-bg" />
                    </label>
                    <label class="palette__field">
                        <span>코드 텍스트</span>
                        <input type="color" id="color-code-text" />
                    </label>
                </div>

                <div class="palette__section">
                    <h2>목록 스타일</h2>
                    <label class="palette__field">
                        <span>글머리 기호</span>
                        <select id="select-list">
                            <option value="disc">● 기본 (disc)</option>
                            <option value="circle">○ circle</option>
                            <option value="square">■ square</option>
                            <option value="none">없음</option>
                        </select>
                    </label>
                    <label class="palette__field">
                        <span>번호 목록</span>
                        <select id="select-olist">
                            <option value="decimal">1, 2, 3</option>
                            <option value="upper-roman">Ⅰ, Ⅱ, Ⅲ</option>
                            <option value="lower-alpha">a, b, c</option>
                            <option value="leading-zero">01, 02, 03</option>
                        </select>
                    </label>
                    <div class="palette__field palette__toggle">
                        <label class="toggle">
                            <input type="checkbox" id="toggle-custom-bullets" />
                            <span>커스텀 글머리 기호 사용</span>
                        </label>
                        <div class="sequence-editor" data-role="bullet-editor">
                            <div class="sequence-editor__list" id="bullet-sequence-list"></div>
                            <button type="button" class="btn btn--ghost btn--xs" id="btn-add-bullet">아이콘 추가</button>
                        </div>
                        <p class="field-help">아이콘 칸을 추가/삭제하며 원하는 순서를 구성하세요. 중첩 목록은 같은 순서로 반복됩니다.</p>
                    </div>
                    <div class="palette__field palette__toggle">
                        <label class="toggle">
                            <input type="checkbox" id="toggle-custom-ordered" />
                            <span>커스텀 번호 스타일 사용</span>
                        </label>
                        <div class="toggle__row">
                            <label>
                                <span>진법 (2~10)</span>
                                <input type="number" id="number-ordered-base" min="2" max="10" step="1" />
                            </label>
                            <label>
                                <span>접두사</span>
                                <input type="text" id="input-ordered-prefix" placeholder="" />
                            </label>
                            <label>
                                <span>접미사</span>
                                <input type="text" id="input-ordered-suffix" placeholder="." />
                            </label>
                        </div>
                        <div class="sequence-editor" data-role="ordered-editor">
                            <div class="sequence-editor__list" id="ordered-sequence-list"></div>
                        </div>
                        <p class="field-help">진법 값과 동일한 개수의 칸이 자동 생성됩니다. 각 칸은 낮은 숫자부터 높은 숫자 순서를 의미합니다.</p>
                    </div>
                </div>

                <div class="palette__section">
                    <h2>레이아웃</h2>
                    <label class="palette__field">
                        <span>페이지 여백 (px)</span>
                        <input type="number" id="number-padding" min="16" max="120" step="4" />
                    </label>
                    <label class="palette__field">
                        <span>줄 간격</span>
                        <input type="number" id="number-line-height" min="1.2" max="2.2" step="0.1" />
                    </label>
                    <label class="palette__field">
                        <span>카드 그림자</span>
                        <select id="select-shadow">
                            <option value="0 30px 60px -30px rgba(37, 99, 235, 0.45)">부드러운 Glow</option>
                            <option value="0 20px 45px -24px rgba(15, 23, 42, 0.32)">딥 쉐도우</option>
                            <option value="0 18px 30px -18px rgba(15, 118, 110, 0.28)">틸 링</option>
                            <option value="none">쉐도우 없음</option>
                        </select>
                    </label>
                </div>
            </aside>
            <button type="button" class="palette__collapse" id="btn-toggle-palette" aria-label="팔레트 접기" aria-pressed="false">◀</button>
        </div>

        <section class="editor" aria-label="마크다운 편집">
            <div class="editor__header">
                <h2>마크다운 문서</h2>
                <span class="tag">실시간 프리뷰</span>
            </div>
            <textarea id="markdown-input" spellcheck="false" placeholder="# 환영합니다!\n\n- 팔레트를 이용해 디자인을 조정하세요.\n- 미리보기 영역이 자동으로 반영됩니다.\n- PDF 다운로드 버튼으로 출력하세요.\n\n> 마크다운 + 커스텀 스타일로 깔끔한 문서를 만들어보세요!\n\n\`\`\`python\nprint('Code blocks도 지원합니다!')\n\`\`\`\n"></textarea>
        </section>

        <section class="preview" aria-label="라이브 미리보기">
            <div class="preview__header">
                <h2>라이브 프리뷰</h2>
                <span class="preview__status" id="preview-status">대기 중</span>
            </div>
            <div class="preview__surface">
                <style id="preview-style"></style>
                <div id="preview-output" class="preview__document"></div>
            </div>
        </section>
    </main>

    <form id="csrf-form" style="display:none;">{% csrf_token %}</form>

    <template id="loading-indicator">
        <div class="loading">
            <div class="loading__spinner"></div>
            <p>PDF 생성 중...</p>
        </div>
    </template>

    <script src="{% static 'editor/js/workspace.js' %}" type="module"></script>
</body>
</html>
